!function(){function a(a){return{value:a,next:void 0,prev:void 0}}function b(){var b,c,d=0;this.add=function(e){var f=a(e);0===d?b=c=f:(f.next=c,c.prev=f,c=f),d++},this.pop=function(){if(0===d)throw new Error("Cannot pop");var a=b.value;return 1===d?b=c=void 0:(b.prev.next=void 0,b=b.prev),d--,a},this.isEmpty=function(){return 0===d},Object.defineProperty(this,"length",{get:function(){return d},set:function(){throw new Error("Readonly property")}})}function c(){var a=new b,c=new b,d=!1,e=function(){for(;!a.isEmpty()&&!c.isEmpty();){var b=a.pop(),e=c.pop();b({done:!1,value:e})}if(d)for(;!a.isEmpty();){var b=a.pop();b({done:!0,value:void 0})}};this.close=function(){d=!0,e()},this.send=function(a){d||(c.add(a),e())},this.next=function(){return new Promise(function(b){a.add(b),e()})},this.nextValue=function(){var a=this.next();a.then(function(a){return a.value})},Object.defineProperty(this,"closed",{get:function(){return d},set:function(){throw new Error("Readonly property")}})}void 0!==window?window.Stream=c:module.exports=c}();